<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯­å¥é€»è¾‘åˆ†æå™¨</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .title {
            text-align: center;
            color: #1976d2;
            margin-bottom: 30px;
            font-size: 24px;
            font-weight: 700;
        }
        
        .analysis-section {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #1976d2;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #1976d2;
            margin-bottom: 15px;
        }
        
        .sentence-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .sentence-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            border-left: 3px solid #28a745;
        }
        
        .sentence-item.duplicate {
            border-left-color: #ffc107;
            background: #fff8e1;
        }
        
        .sentence-item.illogical {
            border-left-color: #dc3545;
            background: #ffebee;
        }
        
        .stats {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 6px;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #1976d2;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .btn {
            background: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 0 10px;
            font-weight: 600;
        }
        
        .btn:hover {
            background: #1565c0;
        }
        
        .btn.danger {
            background: #dc3545;
        }
        
        .btn.warning {
            background: #ffc107;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">åŒ»ç–—æ²Ÿé€šAPP - è¯­å¥é€»è¾‘åˆ†æå™¨</h1>
        
        <div class="controls">
            <button class="btn" onclick="analyzeAllSentences()">åˆ†ææ‰€æœ‰è¯­å¥</button>
            <button class="btn warning" onclick="findDuplicates()">æŸ¥æ‰¾é‡å¤</button>
            <button class="btn danger" onclick="findIllogical()">æŸ¥æ‰¾ä¸åˆç†</button>
            <button class="btn" onclick="exportAnalysis()">å¯¼å‡ºåˆ†æ</button>
        </div>
        
        <div class="stats" id="statsSection">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="totalSentences">-</div>
                    <div class="stat-label">æ€»è¯­å¥æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="logicalSentences">-</div>
                    <div class="stat-label">åˆç†è¯­å¥</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="duplicateSentences">-</div>
                    <div class="stat-label">é‡å¤è¯­å¥</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="illogicalSentences">-</div>
                    <div class="stat-label">ä¸åˆç†è¯­å¥</div>
                </div>
            </div>
        </div>
        
        <div class="analysis-section">
            <div class="section-title">ğŸ” è¯­å¥åˆ†æç»“æœ</div>
            <div id="analysisResults">ç‚¹å‡»"åˆ†ææ‰€æœ‰è¯­å¥"å¼€å§‹åˆ†æ...</div>
        </div>
        
        <div class="analysis-section">
            <div class="section-title">âš ï¸ ä¸åˆç†çš„è¯­å¥ç»„åˆ</div>
            <div id="illogicalResults">ç­‰å¾…åˆ†æ...</div>
        </div>
        
        <div class="analysis-section">
            <div class="section-title">ğŸ”„ é‡å¤çš„è¯­å¥</div>
            <div id="duplicateResults">ç­‰å¾…åˆ†æ...</div>
        </div>
        
        <div class="analysis-section">
            <div class="section-title">âœ… ä¼˜åŒ–å»ºè®®</div>
            <div id="optimizationSuggestions">ç­‰å¾…åˆ†æ...</div>
        </div>
    </div>
    
    <script>
        // æ¨¡æ‹ŸAPPçš„æ•°æ®ç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰
        const appData = {
            persons: ['æˆ‘', 'ä½ ', 'ä»–', 'åŒ»ç”Ÿ', 'æŠ¤å£«', 'å®¶äºº'],
            categories: {
                'è¡£': ['è¡£æœ', 'è£¤å­', 'é‹å­', 'è¢œå­', 'è¢«å­', 'æ•å¤´'],
                'é£Ÿ': ['é¥­', 'èœ', 'æ±¤', 'è¯', 'æ°´', 'èŒ¶'],
                'ä½': ['ç¯', 'ç©ºè°ƒ', 'åºŠ', 'è¢«å­', 'æ¸©åº¦', 'çª—æˆ·'],
                'è¡Œ': ['èµ°è·¯', 'åä¸‹', 'ç«™èµ·', 'è½®æ¤…', 'æ‹æ–', 'æ€æ‰¶'],
                'åŒ»': ['ä½“æ£€', 'ä½é™¢', 'æŠ¤ç†', 'ç–¼ç—›', 'ä¸é€‚', 'æ£€æŸ¥'],
                'å…¶ä»–': ['ä¼‘æ¯', 'ç¡è§‰', 'èµ·åºŠ', 'æ´—æ¾¡', 'ä¸Šå•æ‰€', 'å¸®åŠ©']
            },
            actions: {
                // è¡£ç‰©åŠ¨ä½œ
                clothing: ['ç©¿', 'è„±', 'æ´—', 'æ¢', 'æ•´ç†', 'æ”¶èµ·'],
                // é£Ÿç‰©åŠ¨ä½œ
                food: ['åƒ', 'å–', 'è¦', 'ä¸è¦', 'çƒ­', 'åš'],
                // ç”µå™¨åŠ¨ä½œ
                lighting: ['å¼€', 'å…³', 'è°ƒäº®', 'è°ƒæš—', 'è°ƒäº®åº¦'],
                air_conditioner: ['å¼€', 'å…³', 'å‡æ¸©', 'é™æ¸©', 'è°ƒæ¸©åº¦', 'æ¢æ¨¡å¼'],
                bed: ['è°ƒé«˜', 'è°ƒä½', 'è°ƒåºŠå¤´', 'è°ƒåºŠå°¾', 'èººä¸‹', 'èµ·æ¥'],
                window: ['å¼€', 'å…³', 'å¼€çª—å¸˜', 'å…³çª—å¸˜', 'é€šé£'],
                // åŒ»ç–—åŠ¨ä½œ
                medical: ['éœ€è¦', 'ä¸éœ€è¦', 'è¦', 'ä¸è¦', 'å¥½äº†', 'ç–¼'],
                // è¡ŒåŠ¨åŠ¨ä½œ
                mobility: ['éœ€è¦å¸®åŠ©', 'å¯ä»¥', 'ä¸è¡Œ', 'è¦', 'ä¸è¦', 'ç´¯äº†'],
                // é€šç”¨åŠ¨ä½œ
                common: ['éœ€è¦', 'ä¸éœ€è¦', 'è¦', 'ä¸è¦', 'å¥½äº†', 'è¿˜æ²¡']
            },
            itemActionMapping: {
                'è¡£æœ': 'clothing', 'è£¤å­': 'clothing', 'é‹å­': 'clothing',
                'é¥­': 'food', 'èœ': 'food', 'æ±¤': 'food', 'è¯': 'food',
                'ç¯': 'lighting', 'ç©ºè°ƒ': 'air_conditioner', 'åºŠ': 'bed', 'çª—æˆ·': 'window',
                'ä½“æ£€': 'medical', 'æŠ¤ç†': 'medical', 'ç–¼ç—›': 'medical',
                'èµ°è·¯': 'mobility', 'åä¸‹': 'mobility', 'è½®æ¤…': 'mobility',
                'ä¼‘æ¯': 'common', 'ç¡è§‰': 'common', 'å¸®åŠ©': 'common'
            }
        };
        
        // è¯­å¥æ„å»ºå™¨
        function buildSentence(person, category, item, action) {
            // æ ¹æ®ä¸åŒç»„åˆç”Ÿæˆå¥å­
            if (category === 'åŒ»') {
                if (action === 'éœ€è¦' || action === 'è¦') {
                    return `${person}éœ€è¦${item}`;
                } else if (action === 'ä¸éœ€è¦' || action === 'ä¸è¦') {
                    return `${person}ä¸éœ€è¦${item}`;
                } else {
                    return `${person}${item}${action}`;
                }
            } else if (category === 'è¡£') {
                return `${person}è¦${action}${item}`;
            } else if (category === 'é£Ÿ') {
                if (action === 'åƒ' || action === 'å–') {
                    return `${person}è¦${action}${item}`;
                } else if (action === 'è¦' || action === 'ä¸è¦') {
                    return `${person}${action}${item}`;
                } else {
                    return `${person}è¦${action}${item}`;
                }
            } else if (category === 'ä½') {
                if (item === 'åºŠ') {
                    if (action === 'è°ƒé«˜' || action === 'è°ƒä½') {
                        return `${person}è¦${action}åºŠ`;
                    } else if (action === 'è°ƒåºŠå¤´' || action === 'è°ƒåºŠå°¾') {
                        return `${person}è¦${action}`;
                    } else {
                        return `${person}è¦${action}`;
                    }
                } else if (item === 'ç¯') {
                    return `${person}è¦${action}ç¯`;
                } else if (item === 'ç©ºè°ƒ') {
                    if (action === 'å‡æ¸©' || action === 'é™æ¸©') {
                        return `${person}è¦${action}`;
                    } else {
                        return `${person}è¦${action}ç©ºè°ƒ`;
                    }
                } else if (item === 'çª—æˆ·') {
                    if (action === 'å¼€çª—å¸˜' || action === 'å…³çª—å¸˜' || action === 'é€šé£') {
                        return `${person}è¦${action}`;
                    } else {
                        return `${person}è¦${action}çª—æˆ·`;
                    }
                } else {
                    return `${person}è¦${action}${item}`;
                }
            } else if (category === 'è¡Œ') {
                if (action === 'éœ€è¦å¸®åŠ©' || action === 'å¯ä»¥' || action === 'ä¸è¡Œ' || action === 'ç´¯äº†') {
                    return `${person}${action}`;
                } else {
                    return `${person}è¦${action}`;
                }
            } else {
                return `${person}è¦${action}${item}`;
            }
        }
        
        // åˆ†ææ‰€æœ‰å¯èƒ½çš„è¯­å¥
        function analyzeAllSentences() {
            const allSentences = [];
            const duplicates = [];
            const illogical = [];
            const sentenceCount = {};
            
            // ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ç»„åˆ
            appData.persons.forEach(person => {
                Object.keys(appData.categories).forEach(category => {
                    appData.categories[category].forEach(item => {
                        const actionType = appData.itemActionMapping[item] || 'common';
                        const actions = appData.actions[actionType] || appData.actions.common;
                        
                        actions.forEach(action => {
                            const sentence = buildSentence(person, category, item, action);
                            allSentences.push({
                                person, category, item, action, sentence,
                                path: `${person} â†’ ${category} â†’ ${item} â†’ ${action}`
                            });
                            
                            // ç»Ÿè®¡é‡å¤
                            sentenceCount[sentence] = (sentenceCount[sentence] || 0) + 1;
                        });
                    });
                });
            });
            
            // æŸ¥æ‰¾é‡å¤å’Œä¸åˆç†çš„ç»„åˆ
            allSentences.forEach(item => {
                if (sentenceCount[item.sentence] > 1) {
                    duplicates.push(item);
                }
                
                if (isIllogical(item)) {
                    illogical.push(item);
                }
            });
            
            // æ›´æ–°ç»Ÿè®¡
            document.getElementById('totalSentences').textContent = allSentences.length;
            document.getElementById('logicalSentences').textContent = allSentences.length - illogical.length;
            document.getElementById('duplicateSentences').textContent = Object.keys(sentenceCount).filter(s => sentenceCount[s] > 1).length;
            document.getElementById('illogicalSentences').textContent = illogical.length;
            
            // æ˜¾ç¤ºç»“æœ
            displayAnalysisResults(allSentences);
            displayIllogicalResults(illogical);
            displayDuplicateResults(duplicates, sentenceCount);
            generateOptimizationSuggestions(illogical, duplicates);
            
            return { allSentences, duplicates, illogical, sentenceCount };
        }
        
        // æ£€æŸ¥è¯­å¥æ˜¯å¦ä¸åˆç†
        function isIllogical(item) {
            const { person, category, item: itemName, action, sentence } = item;
            
            // ä¸åˆç†çš„ç»„åˆè§„åˆ™
            const illogicalRules = [
                // åŒ»æŠ¤äººå‘˜ä¸åº”è¯¥è¯´è‡ªå·±ç–¼ç—›
                () => (person === 'åŒ»ç”Ÿ' || person === 'æŠ¤å£«') && (action === 'ç–¼' || action === 'éš¾å—'),
                
                // ä»–äººä¸åº”è¯¥ç›´æ¥æ§åˆ¶åˆ«äººçš„èº«ä½“æ„Ÿå—
                () => person === 'ä»–' && (itemName === 'ç–¼ç—›' || itemName === 'ä¸é€‚'),
                
                // ä¸åˆç†çš„è¡£ç‰©åŠ¨ä½œ
                () => category === 'è¡£' && itemName === 'è¢«å­' && (action === 'ç©¿' || action === 'è„±'),
                
                // ä¸åˆç†çš„é£Ÿç‰©åŠ¨ä½œ
                () => category === 'é£Ÿ' && itemName === 'æ°´' && (action === 'åš' || action === 'çƒ­'),
                
                // ä¸åˆç†çš„è®¾å¤‡æ§åˆ¶
                () => category === 'ä½' && itemName === 'æ¸©åº¦' && (action === 'ç©¿' || action === 'æ´—'),
                
                // åŒ»ç”ŸæŠ¤å£«ä¸åº”è¯¥è¯´è‡ªå·±éœ€è¦åŸºæœ¬æŠ¤ç†
                () => (person === 'åŒ»ç”Ÿ' || person === 'æŠ¤å£«') && category === 'åŒ»' && itemName === 'æŠ¤ç†' && action === 'éœ€è¦',
                
                // ä¸åˆç†çš„è¡ŒåŠ¨ç»„åˆ
                () => category === 'è¡Œ' && itemName === 'è½®æ¤…' && person !== 'æˆ‘' && action === 'ç´¯äº†',
                
                // å®¶äººä¸åº”è¯¥ç›´æ¥æ“ä½œåŒ»ç–—è®¾å¤‡
                () => person === 'å®¶äºº' && category === 'åŒ»' && (itemName === 'ä½“æ£€' || itemName === 'æ£€æŸ¥') && action === 'è¦',
                
                // é‡å¤è¡¨è¾¾
                () => sentence.includes('è¦è¦') || sentence.includes('éœ€è¦éœ€è¦'),
                
                // è¯­æ³•ä¸é€šé¡º
                () => sentence.length < 3 || sentence.includes('undefined')
            ];
            
            return illogicalRules.some(rule => rule());
        }
        
        // æ˜¾ç¤ºåˆ†æç»“æœ
        function displayAnalysisResults(sentences) {
            const results = document.getElementById('analysisResults');
            const categories = {};
            
            sentences.forEach(item => {
                if (!categories[item.category]) {
                    categories[item.category] = [];
                }
                categories[item.category].push(item);
            });
            
            let html = '';
            Object.keys(categories).forEach(category => {
                html += `<h4>${category}ç±» (${categories[category].length}ä¸ªè¯­å¥)</h4>`;
                html += '<div class="sentence-list">';
                categories[category].slice(0, 20).forEach(item => {
                    const cssClass = isIllogical(item) ? 'illogical' : 'sentence-item';
                    html += `<div class="${cssClass}">${item.sentence}</div>`;
                });
                if (categories[category].length > 20) {
                    html += `<div class="sentence-item">... è¿˜æœ‰${categories[category].length - 20}ä¸ªè¯­å¥</div>`;
                }
                html += '</div>';
            });
            
            results.innerHTML = html;
        }
        
        // æ˜¾ç¤ºä¸åˆç†ç»“æœ
        function displayIllogicalResults(illogical) {
            const results = document.getElementById('illogicalResults');
            
            if (illogical.length === 0) {
                results.innerHTML = '<div style="color: #28a745;">âœ… æ²¡æœ‰å‘ç°ä¸åˆç†çš„è¯­å¥ç»„åˆ</div>';
                return;
            }
            
            let html = '<div class="sentence-list">';
            illogical.forEach(item => {
                html += `
                    <div class="sentence-item illogical">
                        <strong>${item.sentence}</strong><br>
                        <small>è·¯å¾„: ${item.path}</small>
                    </div>
                `;
            });
            html += '</div>';
            
            results.innerHTML = html;
        }
        
        // æ˜¾ç¤ºé‡å¤ç»“æœ
        function displayDuplicateResults(duplicates, sentenceCount) {
            const results = document.getElementById('duplicateResults');
            
            const uniqueDuplicates = {};
            duplicates.forEach(item => {
                if (sentenceCount[item.sentence] > 1) {
                    if (!uniqueDuplicates[item.sentence]) {
                        uniqueDuplicates[item.sentence] = [];
                    }
                    uniqueDuplicates[item.sentence].push(item);
                }
            });
            
            if (Object.keys(uniqueDuplicates).length === 0) {
                results.innerHTML = '<div style="color: #28a745;">âœ… æ²¡æœ‰å‘ç°é‡å¤çš„è¯­å¥</div>';
                return;
            }
            
            let html = '';
            Object.keys(uniqueDuplicates).forEach(sentence => {
                const items = uniqueDuplicates[sentence];
                html += `
                    <div class="sentence-item duplicate">
                        <strong>${sentence}</strong> (${items.length}ç§è·¯å¾„)<br>
                        <small>${items.map(item => item.path).join('<br>')}</small>
                    </div>
                `;
            });
            
            results.innerHTML = html;
        }
        
        // ç”Ÿæˆä¼˜åŒ–å»ºè®®
        function generateOptimizationSuggestions(illogical, duplicates) {
            const suggestions = document.getElementById('optimizationSuggestions');
            
            let html = '<ul>';
            
            // åŸºäºä¸åˆç†è¯­å¥çš„å»ºè®®
            if (illogical.length > 0) {
                html += '<li><strong>ç§»é™¤ä¸åˆç†ç»„åˆï¼š</strong>å»ºè®®ç§»é™¤åŒ»æŠ¤äººå‘˜è¡¨è¾¾ç–¼ç—›ã€ä»–äººæ§åˆ¶åˆ«äººæ„Ÿå—ç­‰ä¸åˆç†ç»„åˆ</li>';
            }
            
            // åŸºäºé‡å¤è¯­å¥çš„å»ºè®®
            if (duplicates.length > 0) {
                html += '<li><strong>åˆå¹¶é‡å¤è·¯å¾„ï¼š</strong>å¤šä¸ªæ“ä½œè·¯å¾„ç”Ÿæˆç›¸åŒå¥å­æ—¶ï¼Œå¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªæ›´ç›´è§‚çš„è·¯å¾„</li>';
            }
            
            // é€šç”¨ä¼˜åŒ–å»ºè®®
            html += '<li><strong>è¯­å¥æ¨¡æ¿ä¼˜åŒ–ï¼š</strong>ä¸ºä¸åŒè®¾å¤‡ç±»å‹è®¾è®¡æ›´è‡ªç„¶çš„è¡¨è¾¾æ–¹å¼</li>';
            html += '<li><strong>åŠ¨ä½œåˆ†ç»„ä¼˜åŒ–ï¼š</strong>å°†ç›¸ä¼¼åŠŸèƒ½çš„åŠ¨ä½œå½’ç±»ï¼Œå‡å°‘é€‰æ‹©å¤æ‚åº¦</li>';
            html += '<li><strong>æƒé™æ§åˆ¶ï¼š</strong>æ ¹æ®äººç§°é™åˆ¶æŸäº›ä¸åˆé€‚çš„åŠ¨ä½œé€‰é¡¹</li>';
            html += '<li><strong>æƒ…å¢ƒæ„ŸçŸ¥ï¼š</strong>æ ¹æ®åŒ»é™¢åœºæ™¯ä¼˜åŒ–è¯­å¥è¡¨è¾¾çš„è‡ªç„¶åº¦</li>';
            
            html += '</ul>';
            
            // å…·ä½“çš„ä¼˜åŒ–å»ºè®®
            html += '<h4>å…·ä½“ä¼˜åŒ–æ–¹æ¡ˆï¼š</h4>';
            html += '<div class="sentence-list">';
            
            html += `
                <div class="sentence-item">
                    <strong>1. äººç§°æƒé™æ§åˆ¶</strong><br>
                    é™åˆ¶åŒ»ç”Ÿ/æŠ¤å£«è¯´"æˆ‘ç–¼ç—›"ç­‰ä¸åˆç†è¡¨è¾¾
                </div>
                <div class="sentence-item">
                    <strong>2. åŠ¨ä½œåˆç†æ€§æ£€æŸ¥</strong><br>
                    å¦‚"è¢«å­"ä¸åº”æœ‰"ç©¿/è„±"åŠ¨ä½œ
                </div>
                <div class="sentence-item">
                    <strong>3. å¥å¼æ¨¡æ¿ä¼˜åŒ–</strong><br>
                    ä¸ºè®¾å¤‡æ§åˆ¶è®¾è®¡æ›´è‡ªç„¶çš„è¡¨è¾¾
                </div>
                <div class="sentence-item">
                    <strong>4. é‡å¤è·¯å¾„åˆå¹¶</strong><br>
                    å¤šä¸ªè·¯å¾„ç”Ÿæˆç›¸åŒå¥å­æ—¶è¿›è¡Œåˆå¹¶
                </div>
            `;
            
            html += '</div>';
            suggestions.innerHTML = html;
        }
        
        // æŸ¥æ‰¾é‡å¤
        function findDuplicates() {
            const analysis = analyzeAllSentences();
            console.log('é‡å¤è¯­å¥åˆ†æ:', analysis.duplicates);
        }
        
        // æŸ¥æ‰¾ä¸åˆç†
        function findIllogical() {
            const analysis = analyzeAllSentences();
            console.log('ä¸åˆç†è¯­å¥:', analysis.illogical);
        }
        
        // å¯¼å‡ºåˆ†æç»“æœ
        function exportAnalysis() {
            const analysis = analyzeAllSentences();
            const exportData = {
                timestamp: new Date().toISOString(),
                statistics: {
                    total: analysis.allSentences.length,
                    logical: analysis.allSentences.length - analysis.illogical.length,
                    duplicates: Object.keys(analysis.sentenceCount).filter(s => analysis.sentenceCount[s] > 1).length,
                    illogical: analysis.illogical.length
                },
                illogicalSentences: analysis.illogical,
                duplicateSentences: analysis.duplicates,
                allSentences: analysis.allSentences
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `sentence-analysis-${Date.now()}.json`;
            link.click();
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åˆ†æ
        window.addEventListener('load', () => {
            setTimeout(analyzeAllSentences, 500);
        });
    </script>
</body>
</html>
