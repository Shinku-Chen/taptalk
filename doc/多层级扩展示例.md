# 多层级项目细分 - 扩展示例

## 概述
新的数据结构支持项目的多层级细分，可以根据需求在主项目下添加详细的子项目。比如"体检"下面可以包含"采血"、"CT"、"核磁"等具体检查方式。

## 🏗️ 多层级架构

### 基础4层结构
```
第1层：人称 → 第2层：类别 → 第3层：项目 → 第4层：动作
```

### 扩展5层结构（有子项目时）
```
第1层：人称 → 第2层：类别 → 第3层：项目 → 第4层：子项目 → 第5层：动作
```

## 📊 实际应用示例

### 示例1：体检流程
```
我 → 医 → 体检 → 采血 → 需要
结果：我需要采血

我 → 医 → 体检 → CT → 不需要  
结果：我不需要CT
```

### 示例2：护理流程
```
我 → 医 → 护理 → 换药 → 要
结果：我要换药

护士 → 医 → 护理 → 擦背 → 需要
结果：护士需要擦背
```

### 示例3：住院流程
```
我 → 医 → 住院 → 出院 → 要
结果：我要出院

医生 → 医 → 住院 → 转科 → 需要
结果：医生需要转科
```

## 🔧 数据结构设计

### 子项目定义
```javascript
{
    id: 'checkup',
    text: '体检',
    value: '体检',
    tags: ['检查', '预防'],
    hasSubItems: true,          // 标记有子项目
    subItems: [                 // 子项目数组
        { 
            id: 'blood_test',
            text: '采血',
            value: '采血',
            tags: ['血液', '化验']
        },
        {
            id: 'ct_scan', 
            text: 'CT',
            value: 'CT',
            tags: ['影像', '扫描']
        }
        // ... 更多子项目
    ]
}
```

### 导航逻辑
```javascript
// 检查是否有子项目
if (DataManager.hasSubItems(value)) {
    currentLevel++;
    hasSubLevel = true;
    maxLevels = 5; // 扩展到5层
} else {
    currentLevel++;
    hasSubLevel = false;
    maxLevels = 4; // 保持4层
}
```

## 🎯 扩展能力展示

### 1. 医疗检查细分
- **体检** → 9种具体检查方式
  - 采血、化验、CT、核磁、心电、超声、X光、内镜、活检

- **护理** → 8种具体护理项目
  - 擦背、小便、大便、洗澡、换药、吊水、打针、量体温

- **住院** → 4种住院相关操作
  - 入院、出院、转科、换病房

### 2. 扩展示例：手术分类
```javascript
// 添加手术项目（带6种子分类）
{
    id: 'surgery',
    text: '手术',
    hasSubItems: true,
    subItems: [
        { text: '心脏手术', value: '心脏手术' },
        { text: '脑部手术', value: '脑部手术' },
        { text: '骨科手术', value: '骨科手术' },
        { text: '眼科手术', value: '眼科手术' },
        { text: '牙科手术', value: '牙科手术' },
        { text: '整形手术', value: '整形手术' }
    ]
}
```

### 3. 扩展示例：药物分类
```javascript
// 添加用药项目（带7种药物类型）
{
    id: 'medication',
    text: '用药',
    hasSubItems: true,
    subItems: [
        { text: '止痛药', value: '止痛药' },
        { text: '抗生素', value: '抗生素' },
        { text: '降压药', value: '降压药' },
        { text: '降糖药', value: '降糖药' },
        { text: '安眠药', value: '安眠药' },
        { text: '维生素', value: '维生素' },
        { text: '中药', value: '中药' }
    ]
}
```

## 🌟 技术特性

### 1. 智能层级检测
- 自动检测项目是否有子项目
- 动态调整导航层级数量
- 智能进度指示器更新

### 2. 灵活的句子构建
```javascript
// 4层句子：我要脱衣服
buildCompleteSentence(person, category, item, action)

// 5层句子：我需要采血  
buildCompleteSentenceWithSub(person, category, item, subItem, action)
```

### 3. 动态进度显示
```javascript
// 4层模式：人称 → 类别 → 项目 → 动作
// 5层模式：人称 → 类别 → 项目 → 细项 → 动作
```

## 📱 用户体验

### 操作流程对比

#### 简单项目（4层）
```
我 → 衣 → 衣服 → 脱
进度：人称 ● 类别 ● 项目 ● 动作
结果：我要脱衣服
```

#### 复杂项目（5层）
```
我 → 医 → 体检 → 采血 → 需要
进度：人称 ● 类别 ● 项目 ● 细项 ● 动作
结果：我需要采血
```

### 视觉反馈
- **有子项目的按钮**: 可以添加特殊标识（如小箭头）
- **进度指示器**: 动态显示当前层级数
- **句子构建**: 实时显示构建进度

## 🔨 如何添加新的子项目

### 步骤1：定义主项目
```javascript
const newMainItem = {
    id: 'rehabilitation',
    text: '康复',
    value: '康复',
    tags: ['恢复', '治疗'],
    hasSubItems: true,
    subItems: [
        { id: 'physio', text: '理疗', value: '理疗', tags: ['物理', '康复'] },
        { id: 'exercise', text: '锻炼', value: '锻炼', tags: ['运动', '康复'] },
        { id: 'massage', text: '按摩', value: '按摩', tags: ['放松', '康复'] }
    ]
};
```

### 步骤2：添加到数据中
```javascript
DataManager.addItem('medical', newMainItem);
```

### 步骤3：添加映射关系
```javascript
AppConfig.itemActionMapping['康复'] = 'medical';
AppConfig.itemActionMapping['理疗'] = 'medical';
AppConfig.itemActionMapping['锻炼'] = 'medical';
AppConfig.itemActionMapping['按摩'] = 'medical';
```

### 步骤4：测试功能
```javascript
// 测试路径：我 → 医 → 康复 → 理疗 → 需要
// 预期结果：我需要理疗
```

## 🚀 扩展优势

### 1. **无限层级支持**
- 理论上支持任意深度的子分类
- 动态调整界面和逻辑
- 保持简洁的用户体验

### 2. **智能适配**
- 自动检测是否需要子层级
- 4层/5层模式无缝切换
- 进度指示器自动调整

### 3. **向后兼容**
- 现有数据无需修改
- 渐进式添加子项目
- 保持原有功能不变

### 4. **易于维护**
- 结构化的数据定义
- 统一的访问接口
- 完善的验证机制

## 📝 最佳实践

### 1. **子项目设计原则**
- 每个主项目下不超过12个子项目
- 子项目名称简洁明了
- 合理使用标签分类

### 2. **句式设计原则**
- 保持自然的中文表达
- 考虑不同的语境需求
- 提供多种句式模板

### 3. **扩展建议**
- 优先扩展医疗相关功能
- 根据实际使用反馈调整
- 保持界面简洁不复杂

这个多层级系统为APP提供了强大的扩展能力，可以满足各种复杂的医疗沟通需求。
